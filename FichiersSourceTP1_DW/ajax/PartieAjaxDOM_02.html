<html xmlns="http://www.w3.org/1999/xhtml"><head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>TP MSIF Ajax</title>
  <meta name="author" content="Elöd EGYED-ZSIGMOND">
  
 
<script type="text/javascript">
//fonctions javascript
// <![CDATA[      
  
		  function recupererPremierEnfantDeTypeElement(n) {
			x = n.firstChild;
			while ( x.nodeType != 1 ) { // Test if x is an element node (and not a text node or other)
			  x = x.nextSibling;
			}
			return x;
		  }
		//change le contenu de l'élement avec l'id "nom" avec la chaine de caractéres en paramètre	  
		  function setNom( nom ) {
			var elementHtmlARemplir = window.document.getElementById("id_nom_a_remplacer");
			elementHtmlARemplir.innerHTML = nom;
		  }
		
		//charge le fichier XML se trouvant à l'URL relative donné dans le paramètreet le retourne
        function chargerHttpXML(xmlDocumentUrl) { 
          
          var httpAjax;
          
          httpAjax = window.XMLHttpRequest ?
            new XMLHttpRequest() :
            new ActiveXObject('Microsoft.XMLHTTP');
          
          if (httpAjax.overrideMimeType) {
            httpAjax.overrideMimeType('text/xml');
          }
          
          //chargement du fichier XML à l'aide de XMLHttpRequest synchrone (le 3° paramètre est défini à false)
          httpAjax.open('GET', xmlDocumentUrl, false);
          httpAjax.send();
          
          return httpAjax.responseXML;
        }
  
	 /////////////////////////////////////////////////////////////////////////////////////
  function Bouton2_ajaxEmployees(xmlDocumentUrl) {

		// on révupère grace à la technologie Ajax le fichier xml dont l'URL est passé en paramètre. Le résultat est un élément DOM pointant à la racine du document  
	  var xmlDocument = chargerHttpXML(xmlDocumentUrl);
	  
	  //extraction des noms à partir du document XML en javascript en utilisant la méthode DOM getElementsByTagName qui retourne un tableau d'élements avec la balise "LastName" ici.
	  var lesNoms = xmlDocument.getElementsByTagName("LastName");
	  
	  // Parcours de la liste des noms avec une boucle for et 
	  // construction d'une chaine de charactères contenant les noms séparés par des espaces 
	  // Pour avoir la longueur d'une liste : attribut 'length'
	  // Accès au texte d'un noeud "LastName" : NOM_NOEUD.textContent
	  var chaineDesNoms = "";
	  for (i=0;i<lesNoms.length;i++) {
				if (i>0) { chaineDesNoms = chaineDesNoms +", "; }
				chaineDesNoms=chaineDesNoms +lesNoms[i].textContent + " ";
	  }
	  
	  
	  // Appel de la fonction setNom(...) pour afficher la chaine composé de noms
	  setNom(chaineDesNoms);
	  
	  

  }
			

      // ]]>
</script>

 
</head>
<body
<p>Fichier à modifier/compélter</p>
<p>
  <!--le bouton avec l'événement click 'attribut "onClick" capté. Cet événement appelle la fonction javascript setNom défini dans l'en-tête. -->
  <input name="button" type="button" id="myButton1" onClick="setNom(document.getElementById('myText1').value);" value="1. Remplacer les noms" />

  <!--le champ de saisi avec l'identifiant "myText1" et la valeur par défaut "Toto" -->
  <input name="text" type="text" id="myText1" value="Toto" />
  <br />

  <!--le bouton avec l'événement click 'attribut "onClick" capté. Cet événement appelle la fonction javascript Bouton2_ajaxEmployees défini dans l'en-tête. -->
  <input name="button2" type="button" id="myButton2" onClick="Bouton2_ajaxEmployees('Employees.xml');" value="2. AJAX avec Employees.xml" />
  <br />

</p>
<div>
  <p>Les noms sont : <br/>
      <span id="id_nom_a_remplacer" style="color: red; font-weight: bold;">LES NOMS (Cet &eacute;l&eacute;ment va &ecirc;tre remplac&eacute; par les noms) </span>.</p>
</div>

  
</body>
</html>
